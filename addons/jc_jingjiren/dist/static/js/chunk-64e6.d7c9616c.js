(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-64e6"],{"+sQ5":function(t,e,a){"use strict";a.r(e);var i=a("QbLZ"),s=a.n(i),l=a("ZySA"),n=a("L2JU"),r={data:function(){return{dialogImageUrl:"",dialogVisible:!1,multiple:!0,limit:12}},computed:s()({filelist:function(){for(var t=this.$store.state.state1after.contract,e=[],a=0;a<t.length;a++)e.push({name:t[a].name,url:t[a].path,id:t[a].id});return e}},Object(n.c)({img:function(t){return t.state1after.details.contract_id},baseurl:function(t){return t.baseurl+"r=base/addimg"}})),methods:{handleRemove:function(t,e){for(var a=[],i=0;i<e.length;i++)e[i].response?a.push(e[i].response.id):a.push(e[i].id);this.uploadDetail=a.join(","),this.$store.dispatch("state1after/setfileId",this.uploadDetail)},handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},handleoverlimit:function(){this.$message({message:"文件数量超出限制，最多上传12张图片",type:"warning"})},handleSuccess:function(t,e,a){this.$message({message:"上传成功",type:"success"}),this.uploadDetail=this.img,""===this.uploadDetail?this.uploadDetail=t.id:this.uploadDetail=this.uploadDetail+","+t.id,this.$store.dispatch("state1after/setfileId",this.uploadDetail)},handledefeat:function(t,e,a){this.$message({message:"上传失败",type:"warning"})}}},o=(a("Q+Uv"),a("KHd+")),c=Object(o.a)(r,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"banner"},[a("el-upload",{attrs:{limit:t.limit,multiple:t.multiple,"on-preview":t.handlePictureCardPreview,"on-remove":t.handleRemove,"on-exceed":t.handleoverlimit,"on-success":t.handleSuccess,"on-error":t.handledefeat,"file-list":t.filelist,action:t.baseurl,"list-type":"picture-card"}},[a("i",{staticClass:"el-icon-plus"})]),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("img",{attrs:{src:t.dialogImageUrl,width:"100%",alt:""}})])],1)},[],!1,null,"70b531e3",null);c.options.__file="UploadContract.vue";var d=c.exports,p=a("ZngB"),m=a("xAc7"),u={directives:{waves:l.a},components:{UploadContract:d,SetProcess:p.a},filters:{statusFilter:function(t){return{true:"success",false:"danger"}[t]},typeFilter:function(t){return t}},data:function(){return{signamount:"",activeName:"first"}},computed:s()({},Object(n.c)({processTypeOptions:function(t){return t.projectindex.list},id:function(t){return t.state1after.selectitemID},formDatadetail:function(t){return t.state1after.details},steps:function(t){return t.state1after.steps},uploadcontractID:function(t){return t.state1after.details.contract_id}})),created:function(){this.getinfo()},methods:{getinfo:function(){var t=this;Object(m.b)(this.$route.query.id).then(function(e){t.$store.dispatch("state1after/getstate1member",e)})},handlesubmit:function(){var t=this;this.$confirm("是否确认提交合同","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(m.c)(t.$route.query.id,t.formDatadetail.total_price,t.uploadcontractID).then(function(e){"success"===e.status.state&&t.$message({type:"success",message:"提交成功!"})})}).catch(function(){})},handleProcesssubmit:function(){for(var t=this,e=this.steps,a=0,i=0;i<e.length;i++)a+=parseInt(null===e[i].price?0:e[i].price);if(100!==a)return this.$message({message:"请输入正确的收款比例数值，所有步骤总和为100%",type:"warning"}),!1;this.$confirm("是否确认提交流程设置, 提交后该业务自动进入服务中状态","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(m.d)(t.$route.query.id,t.steps).then(function(e){"success"===e.status.state?(t.$message({type:"success",message:"提交成功!"}),t.$router.go(-1)):"contract"===e.status.state?t.$message({type:"warning",message:"未上传合同，设置服务流程前请先上传合同并设置签约金额！"}):t.$message({type:"warning",message:"上传失败，请稍后重试"})})}).catch(function(){})}}},f=(a("RIZV"),Object(o.a)(u,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-tabs",{staticClass:"tab-scroll",model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{staticClass:"el-tab-pane",attrs:{label:"上传合同",name:"first"}},[a("keep-alive",[a("div",{attrs:{name:"first"}},[a("el-row",{staticStyle:{"margin-bottom":"0px"},attrs:{gutter:3}},[a("el-col",{staticStyle:{height:"100%"},attrs:{span:4}},[a("div",{staticClass:"grid-content left-title"},[t._v("\n                  业务信息\n                ")])]),t._v(" "),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content"},[a("el-form",{staticStyle:{padding:"0 30px"},attrs:{model:t.formDatadetail,"label-position":"right","label-width":"100px"}},[a("el-form-item",{attrs:{label:"业务ID"}},[a("div",{staticClass:"input-item"},[t._v(t._s(t.formDatadetail.task_number))])]),t._v(" "),a("el-form-item",{attrs:{label:"所属项目名称"}},[a("div",{staticClass:"input-item"},[t._v(t._s(t.formDatadetail.projectname))])]),t._v(" "),a("el-form-item",{attrs:{label:"业务联系人"}},[a("div",{staticClass:"input-item"},[t._v(t._s(t.formDatadetail.username))])]),t._v(" "),a("el-form-item",{attrs:{label:"业务联系方式"}},[a("div",{staticClass:"input-item"},[t._v(t._s(t.formDatadetail.userphone))])]),t._v(" "),a("el-form-item",{attrs:{label:"提交时间"}},[a("div",{staticClass:"input-item"},[t._v(t._s(t.formDatadetail.create_time))])]),t._v(" "),a("el-form-item",{attrs:{label:"签约时间"}},[a("div",{staticClass:"input-item"},[t._v(t._s(t.formDatadetail.time))])]),t._v(" "),a("el-form-item",{attrs:{label:"提交备注"}},[a("div",{staticClass:"input-item input-item-text"},[t._v(t._s(t.formDatadetail.describe))])])],1)],1)]),t._v(" "),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple",staticStyle:{padding:"16px 0"}},[a("div",{staticClass:"grid-content-rt",staticStyle:{"border-bottom":"3px solid rgb(239,244,250)"}},[a("el-form",{staticStyle:{padding:"0 30px","max-width":"500px",margin:"auto"},attrs:{model:t.formDatadetail,"label-position":"left","label-width":"80px",size:"mini"}},[a("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"经纪人"}},[a("div",{staticClass:"input-item-rt"},[t._v(t._s(t.formDatadetail.main_name))])]),t._v(" "),a("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"联系方式"}},[a("div",{staticClass:"input-item-rt"},[t._v(t._s(t.formDatadetail.main_phone))])]),t._v(" "),a("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"预计佣金"}},[a("div",{staticClass:"input-item-rt"},[t._v(t._s(t.formDatadetail.min_vtmoney)+" -- "+t._s(t.formDatadetail.max_vtmoney)+"元 ")])]),t._v(" "),a("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"累计佣金"}},[a("div",{staticClass:"input-item-rt"},[t._v(t._s(t.formDatadetail.main_allmoney)+"元")])])],1)],1),t._v(" "),a("div",{staticClass:"grid-content-rb",staticStyle:{padding:"0 30px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("div",{staticClass:" bg-purple-dark",staticStyle:{padding:"0"}},[a("h6",[t._v("一级分销商")]),t._v(" "),t.formDatadetail.one_name?a("el-form",{attrs:{model:t.formDatadetail,"label-position":"left","label-width":"80px",size:"mini"}},[a("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"姓名:"}},[a("div",{staticClass:"input-item-rb"},[t._v(t._s(t.formDatadetail.one_name))])]),t._v(" "),a("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"联系方式:"}},[a("div",{staticClass:"input-item-rb"},[t._v(t._s(t.formDatadetail.one_phone))])]),t._v(" "),a("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"加入时间:"}},[a("div",{staticClass:"input-item-rb"},[t._v(t._s(t.formDatadetail.one_time))])]),t._v(" "),a("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"预计佣金:"}},[a("div",{staticClass:"input-item-rb"},[t._v("￥"+t._s(t.formDatadetail.one_thismoney))])])],1):a("el-form",{attrs:{model:t.formDatadetail,"label-position":"left","label-width":"80px",size:"mini"}},[a("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"无"}})],1)],1)]),t._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"bg-purple-dark",staticStyle:{padding:"0"}},[a("h6",[t._v("二级分销商")]),t._v(" "),t.formDatadetail.two_name?a("el-form",{attrs:{model:t.formDatadetail,"label-position":"left","label-width":"80px",size:"mini"}},[a("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"姓名:"}},[a("div",{staticClass:"input-item-rb"},[t._v(t._s(t.formDatadetail.two_name))])]),t._v(" "),a("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"联系方式:"}},[a("div",{staticClass:"input-item-rb"},[t._v(t._s(t.formDatadetail.two_phone))])]),t._v(" "),a("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"加入时间:"}},[a("div",{staticClass:"input-item-rb"},[t._v(t._s(t.formDatadetail.two_time))])]),t._v(" "),a("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"预计佣金:"}},[a("div",{staticClass:"input-item-rb"},[t._v("￥"+t._s(t.formDatadetail.two_thismoney))])])],1):a("el-form",{attrs:{model:t.formDatadetail,"label-position":"left","label-width":"80px",size:"mini"}},[a("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"无"}})],1)],1)])],1)],1)])])],1),t._v(" "),a("el-row",{staticStyle:{"padding-top":"0px","border-top":"3px solid rgb(239,244,250)","margin-bottom":"0px"},attrs:{gutter:3}},[a("el-col",{staticStyle:{height:"100%"},attrs:{span:4}},[a("div",{staticClass:"grid-content  grid-content-l left-title",staticStyle:{"min-height":"100px"}},[t._v("\n                  业务签约金额\n                ")])]),t._v(" "),a("el-col",{staticClass:"grid-content-wrapper",attrs:{span:20}},[a("div",{staticClass:"grid-content grid-content-r",staticStyle:{"min-height":"100px"}},[a("el-form",{staticStyle:{padding:"0 30px"},attrs:{"label-position":"right","label-width":"0px"}},[a("el-form-item",[a("el-input",{staticStyle:{width:"300px","margin-top":"10px"},attrs:{placeholder:"请输入签约金额"},model:{value:t.formDatadetail.total_price,callback:function(e){t.$set(t.formDatadetail,"total_price",e)},expression:"formDatadetail.total_price"}})],1)],1)],1)])],1),t._v(" "),a("el-row",{staticStyle:{"padding-top":"0px","border-top":"3px solid rgb(239,244,250)","margin-bottom":"0px",background:"white"},attrs:{gutter:5}},[a("el-col",{staticStyle:{height:"100%"},attrs:{span:4}},[a("div",{staticClass:"grid-content  grid-content-l left-title",staticStyle:{"min-height":"200px"}},[t._v("\n                  合同上传\n                ")])]),t._v(" "),a("el-col",{staticClass:"grid-content-wrapper",staticStyle:{"border-left":"3px solid rgb(239,244,250)"},attrs:{span:20}},[a("div",{staticClass:"grid-content grid-content-r",staticStyle:{"min-height":"200px"}},[a("upload-contract")],1)])],1),t._v(" "),a("el-row",{staticStyle:{background:"white","margin-top":"3px",padding:"20px"},attrs:{gutter:3}},[a("el-col",{staticStyle:{background:"white","text-align":"right"},attrs:{span:24}},[a("el-button",{attrs:{type:"primary"},on:{click:t.handlesubmit}},[t._v("提交")])],1)],1)],1)])],1),t._v(" "),a("el-tab-pane",{staticClass:"el-tab-pane",attrs:{label:"服务流程设计",name:"third"}},[a("keep-alive",[a("div",{attrs:{name:"third"}},[a("el-row",{staticStyle:{"margin-bottom":"0px",background:"white"},attrs:{gutter:3}},[a("el-col",{staticStyle:{height:"100%"},attrs:{span:5}},[a("div",{staticClass:"grid-content left-title"},[t._v("\n                  流程设置\n                ")])]),t._v(" "),a("el-col",{attrs:{span:19}},[a("div",{staticClass:"grid-content grid-content-r grid-content-xm",staticStyle:{"border-left":"2px solid rgba(239, 244, 250, 1)"}},[a("set-process"),t._v(" "),a("el-row",{staticStyle:{background:"white","margin-top":"3px",padding:"20px","border-top":"2px solid rgba(239, 244, 250, 1)"},attrs:{gutter:3}},[a("el-col",{staticStyle:{background:"white","text-align":"right"},attrs:{span:24}},[a("el-button",{attrs:{type:"primary"},on:{click:t.handleProcesssubmit}},[t._v("提交流程")])],1)],1)],1)])],1)],1)])],1)],1)],1)])},[],!1,null,"16579c04",null));f.options.__file="stateToload.vue";e.default=f.exports},AMsw:function(t,e,a){"use strict";var i=a("nb62");a.n(i).a},"Q+Uv":function(t,e,a){"use strict";var i=a("vU7u");a.n(i).a},RIZV:function(t,e,a){"use strict";var i=a("RmmD");a.n(i).a},RmmD:function(t,e,a){},ZngB:function(t,e,a){"use strict";var i=a("QbLZ"),s=a.n(i),l=a("L2JU"),n={name:"SetProcess",data:function(){return{protype:[{value:"进程",id:"2"},{value:"收款",id:"1"}]}},computed:s()({},Object(l.c)({steps:function(t){return t.state1after.steps}})),methods:{resetForm:function(t){this.$refs[t].resetFields()},removeDomain:function(t){var e=this.steps.indexOf(t);-1!==e&&this.steps.splice(e,1)},addDomain:function(){var t=this.steps.length;this.steps.splice(t-1,0,{process_name:"",key:Date.now(),price:null,content_type:"2"})}}},r=(a("AMsw"),a("KHd+")),o=Object(r.a)(n,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._m(0),t._v(" "),a("el-form",{ref:"steps",staticClass:"demo-dynamic",attrs:{"label-width":"80px"}},[t._l(t.steps,function(e,i){return a("el-form-item",{key:e.key,attrs:{label:"第"+ ++i+"步"}},[a("el-input",{staticClass:"process-title-input",attrs:{disabled:1==i||i==t.steps.length,clearable:""},model:{value:e.process_name,callback:function(a){t.$set(e,"process_name",a)},expression:"domain.process_name"}}),t._v(" "),a("el-select",{staticClass:"process-type-input",attrs:{placeholder:"类型",disabled:1==i||i==t.steps.length},model:{value:e.content_type,callback:function(a){t.$set(e,"content_type",a)},expression:"domain.content_type"}},t._l(t.protype,function(t){return a("el-option",{key:t.id,attrs:{label:t.value,value:t.id}})})),t._v(" "),"1"==e.content_type?[a("el-input",{staticClass:"process-proportion-input",attrs:{prop:"price"},model:{value:e.price,callback:function(a){t.$set(e,"price",a)},expression:"domain.price"}}),t._v(" "),a("span",{staticClass:"info-yj-input-text"},[t._v("%")])]:t._e(),t._v(" "),1!=i&&i!=t.steps.length?a("i",{staticClass:"el-icon-delete el-icon",staticStyle:{cursor:"pointer"},on:{click:function(a){a.preventDefault(),t.removeDomain(e)}}}):t._e()],2)}),t._v(" "),a("el-form-item",[a("el-button",{on:{click:t.addDomain}},[t._v("新增步骤")])],1)],2)],1)},[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"theader",staticStyle:{"max-width":"800px","min-width":"790px",margin:"auto"}},[a("div",{staticStyle:{display:"inline-block","text-align":"center",width:"80px"}},[t._v("序号")]),t._v(" "),a("div",{staticStyle:{display:"inline-block","text-align":"center",width:"300px"}},[t._v("名称")]),t._v(" "),a("div",{staticStyle:{display:"inline-block","text-align":"center",width:"200px"}},[t._v("类型")]),t._v(" "),a("div",{staticStyle:{display:"inline-block","text-align":"center",width:"100px"}},[t._v("比例")]),t._v(" "),a("div",{staticStyle:{display:"inline-block","text-align":"center",width:"100px"}},[t._v("操作")])])}],!1,null,"654dfd75",null);o.options.__file="SetProcess.vue";e.a=o.exports},ZySA:function(t,e,a){"use strict";var i=a("P2sY"),s=a.n(i),l=(a("jUE0"),{bind:function(t,e){t.addEventListener("click",function(a){var i=s()({},e.value),l=s()({ele:t,type:"hit",color:"rgba(0, 0, 0, 0.15)"},i),n=l.ele;if(n){n.style.position="relative",n.style.overflow="hidden";var r=n.getBoundingClientRect(),o=n.querySelector(".waves-ripple");switch(o?o.className="waves-ripple":((o=document.createElement("span")).className="waves-ripple",o.style.height=o.style.width=Math.max(r.width,r.height)+"px",n.appendChild(o)),l.type){case"center":o.style.top=r.height/2-o.offsetHeight/2+"px",o.style.left=r.width/2-o.offsetWidth/2+"px";break;default:o.style.top=(a.pageY-r.top-o.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",o.style.left=(a.pageX-r.left-o.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return o.style.backgroundColor=l.color,o.className="waves-ripple z-active",!1}},!1)}}),n=function(t){t.directive("waves",l)};window.Vue&&(window.waves=l,Vue.use(n)),l.install=n;e.a=l},jUE0:function(t,e,a){},nb62:function(t,e,a){},vU7u:function(t,e,a){},xAc7:function(t,e,a){"use strict";a.d(e,"a",function(){return r}),a.d(e,"b",function(){return o}),a.d(e,"c",function(){return c}),a.d(e,"d",function(){return d});var i=a("Kw5r"),s=a("vDqi"),l=a.n(s),n=a("Q2AE");i.default.use(l.a);var r=function(t){return l.a.get(n.a.state.baseurl+"r=bk-task",{params:{page:t.page,size:t.limit,name:t.title,category_id:t.type,check:2,state:4,stop:0}}).then(function(t){return t.data})},o=function(t){return l.a.get(n.a.state.baseurl+"r=bk-check/task-detail",{params:{id:t}}).then(function(t){return t.data})},c=function(t,e,a){return l.a.get(n.a.state.baseurl+"r=bk-check/contract",{params:{id:t,total_price:e,contract_id:a}}).then(function(t){return t.data})},d=function(t,e){return l.a.post(n.a.state.baseurl+"r=bk-task/addprocess",{id:t,process:e}).then(function(t){return t.data})}}}]);