(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-abc9"],{"7uUY":function(t,e,i){"use strict";i.r(e);var n=i("QbLZ"),s=i.n(n),a=i("L2JU"),l=i("Kw5r"),r=i("vDqi"),c=i.n(r),o=i("Q2AE");l.default.use(c.a);var u=function(t,e,i){return c.a.post(o.a.state.baseurl+"r=bk-task/stop",{id:e,state:t,why:i}).then(function(t){return t.data})},p=i("bN1i"),d={name:"ComplexTable",directives:{waves:i("ZySA").a},components:{},filters:{statusFilter:function(t){return{true:"success",false:"danger"}[t]},timeFilter:function(t){return""===t||null==t?"--/--":t},pageFilters:function(t){return parseInt(t)},processStateFilter:function(t){switch(t.state){case"3":return t.finish_time;case"2":return"进行中";default:return"未开始"}}},data:function(){return{listLoading:!0,listQuery:{page:1,limit:10,title:void 0,type:void 0},list:[],page:{},dialogFormVisible:!1,dialogProcessVisible:!1,selectitem:null,active:"",steps:[]}},computed:s()({},Object(a.c)({processTypeOptions:function(t){return t.projectindex.list}})),created:function(){this.getList(),this.getCategory()},methods:{getList:function(){var t=this;(function(t){return c.a.get(o.a.state.baseurl+"r=bk-task",{params:{page:t.page,size:t.limit,name:t.title,category_id:t.type,check:2,state:1,stop:0}}).then(function(t){return t.data})})(this.listQuery).then(function(e){t.listLoading=!1,t.list=e.list,t.page=e.page})},getCategory:function(){Object(p.d)(this,this.listQuery)},handleFilter:function(){this.listQuery.page=1,this.getList()},handleSizeChange:function(t){this.listQuery.limit=t,this.getList()},handleCurrentChange:function(t){this.listQuery.page=t,this.getList()},handleUpdate:function(t){this.selectitem=t,this.steps=this.selectitem.process,this.dialogFormVisible=!0;var e=this.selectitem.process;if("3"===e[e.length-1].state)this.active=e.length;else for(var i=0;i<e.length;i++)if("2"===e[i].state){this.active=i;break}},handleDelete:function(t){var e=this;this.$confirm("此操作将删除该项目相关信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){(function(t){return c.a.get(o.a.state.baseurl+"r=bk-task/stop",{params:{id:t}}).then(function(t){return t.data})})(t.id).then(function(t){"success"===t.status.state&&(e.getList(),e.$message({type:"success",message:"删除成功!"}))})}).catch(function(){})},handlenext:function(){var t=this;this.active>this.steps.length-1?this.$message({message:"洽谈阶段已完成,点击提交进入上传合同阶段",type:"success"}):this.$confirm("更新洽谈流程进度, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.dialogFormVisible=!1,function(t){return c.a.post(o.a.state.baseurl+"r=bk-task/shenprocess",{id:t}).then(function(t){return t.data})}(t.steps[t.active].id).then(function(e){"success"===e.status.state&&(t.getList(),t.$message({type:"success",message:"更新成功!"}))})}).catch(function(){})},handleComplate:function(t){var e=this;"3"===t.process[t.process.length-1].state?this.$confirm("洽谈成功，进入上传合同流程, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){u("1",t.id,null).then(function(t){"success"===t.status.state&&(e.getList(),e.$message({type:"success",message:"更新成功!"}))})}).catch(function(){}):this.$message({type:"warning",message:"洽谈步骤未完成"})},handleBackto:function(t){var e=this;this.$prompt("更新洽谈状态，请输入洽谈失败原因原因","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(i){var n=i.value;if(""===n||null==n)return e.$message({type:"warning",message:"请输入洽谈失败原因原因"}),!1;u("0",t.id,n).then(function(t){"success"===t.status.state&&(e.getList(),e.$message({type:"success",message:"更新成功!"}))})}).catch(function(){})}}},f=(i("Wgki"),i("KHd+")),h=Object(f.a)(d,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container",staticStyle:{background:"#ffffff",padding:"16px"}},[i("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"联系人"},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleFilter(e):null}},model:{value:t.listQuery.title,callback:function(e){t.$set(t.listQuery,"title",e)},expression:"listQuery.title"}}),t._v(" "),i("el-select",{staticClass:"filter-item",staticStyle:{width:"130px"},attrs:{clearable:"",placeholder:"项目分类"},model:{value:t.listQuery.type,callback:function(e){t.$set(t.listQuery,"type",e)},expression:"listQuery.type"}},t._l(t.processTypeOptions,function(t){return i("el-option",{key:t.title,attrs:{label:t.title,value:t.id}})})),t._v(" "),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.handleFilter}},[t._v("搜索\n    ")])],1),t._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.list,"tooltip-effect":"dark",border:""}},[i("el-table-column",{attrs:{label:"序号",type:"index",width:"60",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{prop:"task_number",label:"业务编号",width:"120",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{label:"业务名称",align:"center","min-width":"200px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-row",[i("el-col",{staticClass:"ywitem-l",attrs:{span:6}},[i("div",{},[i("img",{staticClass:"ywitem-l-img",attrs:{src:e.row.img_path,alt:""}})])]),t._v(" "),i("el-col",{staticClass:"ywitem-r",attrs:{span:18}},[i("div",{},[i("div",{staticClass:"ywitem-r-title"},[t._v(t._s(e.row.taskname))]),t._v(" "),i("div",t._l(e.row.tags,function(e){return i("el-tag",{key:e.key,staticStyle:{"margin-right":"3px"},attrs:{size:"mini",type:"success"}},[t._v(t._s(e)+"\n                ")])}))])])],1)]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"username",label:"业务联系人",width:"120",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{prop:"userphone",label:"联系方式",width:"120",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{label:"提交时间",width:"180",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.time)+"\n      ")]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"expect_commission",label:"预计佣金",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{staticStyle:{color:"red"}},[t._v("￥"+t._s(e.row.min_price)+"--"+t._s(e.row.max_price))])]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"name",label:"经纪人",width:"100",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{prop:"state",label:"状态",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-tag",[t._v("洽谈中")])]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"process",label:"洽谈进度",width:"160",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{staticClass:"link-type",on:{click:function(i){t.handleUpdate(e.row)}}},[t._v(t._s(e.row.processname))])]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"操作",width:"160","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"更新洽谈进度",placement:"top"}},[i("i",{staticClass:"el-icon-refresh el-icon",on:{click:function(i){t.handleUpdate(e.row)}}})]),t._v(" "),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"洽谈完成并进入待传合同流程",placement:"top"}},[i("i",{staticClass:"el-icon-check el-icon",on:{click:function(i){t.handleComplate(e.row)}}})]),t._v(" "),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"洽谈失败",placement:"top"}},[i("i",{staticClass:"el-icon-close el-icon",on:{click:function(i){t.handleBackto(e.row)}}})]),t._v(" "),i("router-link",{attrs:{to:{path:"/business/detailqiatan",query:{id:e.row.id}}}},[i("i",{staticClass:"el-icon-view el-icon",on:{click:function(i){t.handledetail(e.row)}}})])]}}])})],1),t._v(" "),i("div",{staticClass:"pagination-container",staticStyle:{background:"white","margin-top":"0","text-align":"right",padding:"16px"}},[i("el-pagination",{attrs:{"current-page":t.listQuery.page,"page-sizes":[10,20,30,50],"page-size":t.listQuery.limit,total:t._f("pageFilters")(t.page.data_total),background:"",layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),t._v(" "),i("el-dialog",{attrs:{visible:t.dialogFormVisible,title:"更新洽谈进度"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[i("el-steps",{staticStyle:{"min-width":"500px"},attrs:{model:t.steps,active:t.active,"align-center":"","finish-status":"success"}},t._l(t.steps,function(e){return i("el-step",{attrs:{title:e.process_name,description:t._f("processStateFilter")(e)}})})),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.handlenext}},[t._v("下一步")])],1)],1)],1)},[],!1,null,"c78d1742",null);h.options.__file="state1.vue";e.default=h.exports},Wgki:function(t,e,i){"use strict";var n=i("l3sI");i.n(n).a},ZySA:function(t,e,i){"use strict";var n=i("P2sY"),s=i.n(n),a=(i("jUE0"),{bind:function(t,e){t.addEventListener("click",function(i){var n=s()({},e.value),a=s()({ele:t,type:"hit",color:"rgba(0, 0, 0, 0.15)"},n),l=a.ele;if(l){l.style.position="relative",l.style.overflow="hidden";var r=l.getBoundingClientRect(),c=l.querySelector(".waves-ripple");switch(c?c.className="waves-ripple":((c=document.createElement("span")).className="waves-ripple",c.style.height=c.style.width=Math.max(r.width,r.height)+"px",l.appendChild(c)),a.type){case"center":c.style.top=r.height/2-c.offsetHeight/2+"px",c.style.left=r.width/2-c.offsetWidth/2+"px";break;default:c.style.top=(i.pageY-r.top-c.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",c.style.left=(i.pageX-r.left-c.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return c.style.backgroundColor=a.color,c.className="waves-ripple z-active",!1}},!1)}}),l=function(t){t.directive("waves",a)};window.Vue&&(window.waves=a,Vue.use(l)),a.install=l;e.a=a},bN1i:function(t,e,i){"use strict";i.d(e,"d",function(){return r}),i.d(e,"e",function(){return c}),i.d(e,"a",function(){return o}),i.d(e,"c",function(){return u}),i.d(e,"b",function(){return p}),i.d(e,"f",function(){return d});var n=i("Kw5r"),s=i("vDqi"),a=i.n(s),l=i("Q2AE");function r(t,e){a.a.get(t.$store.state.baseurl+"r=bk-category",{params:{page:e.page,size:e.limit}}).then(function(e){t.$store.dispatch("projectindex/getcategory",e.data)}).catch(function(t){console.log(t)})}n.default.use(a.a);var c=function(t){return a.a.get(l.a.state.baseurl+"r=bk-category",{params:{page:t.page,size:t.limit}}).then(function(t){return t.data})},o=function(t){return a.a.post(l.a.state.baseurl+"r=bk-category/createup",{title:t.title,is_open:t.is_open,is_index:t.is_index,description:t.description}).then(function(t){return t.data})},u=function(t){return a.a.post(l.a.state.baseurl+"r=bk-category/createup",{id:t.id,title:t.title,is_open:t.is_open,is_index:t.is_index,description:t.description}).then(function(t){return t.data})},p=function(t){return a.a.get(l.a.state.baseurl+"r=bk-category/del",{params:{id:t}}).then(function(t){return t.data})},d=function(t){return a.a.get(l.a.state.baseurl+"r=bk-category/one",{params:{id:t}}).then(function(t){return t.data})}},jUE0:function(t,e,i){},l3sI:function(t,e,i){}}]);